# WARNING - Generated by {fusen} from dev/flat_regress_dataset.Rmd: do not edit by hand

#' regress_dataset
#' 
#' @param data data.frame The dataset to perform regression on, must have "x" and "y" numerical column
#' @param view_type character The type of output to view result, can be "sjTable", "DT" or "kable"
#' @param save logical Whether output should be saved
#' @param path character Path to the saved output file
#' 
#' @importFrom stats lm
#' @importFrom sjPlot tab_model
#' @importFrom DT datatable
#' @importFrom knitr kable
#' @importFrom broom tidy
#' @importFrom readr write_rds
#' @importFrom glue glue
#'
#' @return table The summarised regression info
#' @export
#' @examples
#' data <- fetch_dataset(type = "penguin")
#' reg <- regress_dataset(data = data, view_type = "sjTable")
#' reg
regress_dataset <- function(data, view_type = c("sjTable","kable","DT"), save = FALSE, path = "lm_params.rds") {
  
  view_type = match.arg(view_type)
  
  # perform linear regression
  reg <- lm(data = data)

  # save
  if (isTRUE(save)) {
    message(glue("Saving output in {path}"))
    write_rds(x = tidy(reg), file = path)
  }
  
  # show
  if (view_type == "DT") {
    reg <- reg %>% tidy() %>% datatable()
  } else if (view_type == "kable") {
    reg <- reg %>% tidy() %>% kable()
  } else if (view_type == "sjTable") {
    reg <- reg %>% tab_model()
  }
  
  return(reg)
}
