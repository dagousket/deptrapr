# WARNING - Generated by {fusen} from dev/flat_regress_dataset.Rmd: do not edit by hand

test_that("regress_dataset works", {
  tmp_output <- tempfile(pattern = "regression")
  dir.create(tmp_output)
  
  data <- fetch_dataset(type = "penguin")
  
  reg_dt <- regress_dataset(data = data, view_type = "DT")
  reg_sj <- regress_dataset(data = data, view_type = "sjTable")
  reg_kb <- regress_dataset(data = data, view_type = "kable", save = TRUE, path = file.path(tmp_output, "lm_params.rds"))
  
  expect_s3_class(object = reg_dt,
                  class = c("datatables", "htmlwidget")
                  )

  expect_s3_class(object = reg_sj,
                  class = "sjTable"
                  )
  
  expect_s3_class(object = reg_kb,
                  class = c("knitr_kable")
                  )
  
  expect_true(file.exists(file.path(tmp_output, "lm_params.rds")))
  unlink(tmp_output, recursive = TRUE)

})
